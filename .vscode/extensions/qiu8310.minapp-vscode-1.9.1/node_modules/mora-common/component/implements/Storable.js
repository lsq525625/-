"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var React = require("react");
var applyMixins_1 = require("../../util/applyMixins");
var Storable = /** @class */ (function (_super) {
    tslib_1.__extends(Storable, _super);
    function Storable() {
        return _super !== null && _super.apply(this, arguments) || this;
    }
    /**
     * 在继承的子类中写
     *
     * ```
     * storable: boolean
     * store: IStorableFunc
     * ```
     *
     * 继承的子类的 props 需要合并 `IStorableProps`
     */
    Storable.apply = function () {
        return function (Ctor) { return applyMixins_1.applyMixins(Ctor, Storable); };
    };
    Object.defineProperty(Storable.prototype, "storable", {
        get: function () {
            return !!(this.props.store && this.props.storeKey);
        },
        enumerable: true,
        configurable: true
    });
    Storable.prototype.store = function (key, value) {
        var _a = this.props, store = _a.store, storeKey = _a.storeKey;
        var isGet = typeof value === 'undefined';
        if (store != null && storeKey != null) {
            storeKey = 'Storable__' + storeKey;
            if (!store[storeKey]) {
                if (isGet)
                    return;
                else
                    store[storeKey] = {};
            }
            if (isGet)
                return store[storeKey][key];
            else
                store[storeKey][key] = value;
        }
    };
    return Storable;
}(React.PureComponent));
exports.Storable = Storable;
