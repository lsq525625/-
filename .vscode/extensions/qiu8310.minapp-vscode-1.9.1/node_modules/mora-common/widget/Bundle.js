"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
// 参考 https://reacttraining.com/react-router/web/guides/code-splitting
var React = require("react");
var Bundle = /** @class */ (function (_super) {
    tslib_1.__extends(Bundle, _super);
    function Bundle() {
        var _this = _super !== null && _super.apply(this, arguments) || this;
        _this.state = { mod: null };
        return _this;
    }
    Bundle.prototype.componentWillMount = function () {
        this.load(this.props);
    };
    Bundle.prototype.componentWillReceiveProps = function (nextProps) {
        if (nextProps.load !== this.props.load) {
            this.load(nextProps);
        }
    };
    Bundle.prototype.load = function (props) {
        var _this = this;
        if (this.state.mod !== null)
            this.setState({ mod: null });
        props.load(function (mod) {
            // handle both es imports and cjs
            var modKey = props.modKey || 'default';
            _this.setState({ mod: mod[modKey] ? mod[modKey] : mod });
        });
    };
    Bundle.prototype.render = function () {
        var _a = this, _b = _a.props, children = _b.children, loading = _b.loading, mod = _a.state.mod;
        return mod ? children(mod) : (loading || null);
    };
    return Bundle;
}(React.PureComponent));
exports.Bundle = Bundle;
